//Reloading in the guns is based off of complex doom

Actor NewPistol : Pistol replaces Pistol
{
  Decal BulletChip
  Weapon.PreferredSkin "PistolMarine"
  Weapon.SlotNumber 2
  Weapon.AmmoType "PistolClip"
  Weapon.AmmoType2 "Clip"  
  Weapon.AmmoUse 1
  Weapon.AmmoGive2 20
  Weapon.AmmoGive 0
  +WEAPON.AMMO_OPTIONAL
  +WEAPON.NOALERT
  States
  {
  Deselect:
    PISG A 1 A_Lower
	PISG A 0 A_Lower
	PISG A 0 A_Lower
    Loop
  Select:
    PISG A 1 A_Raise
	PISG A 0 A_Raise
	PISG A 0 A_Raise
    Loop
  Fire:
    PISG A 0 A_JumpIfNoAmmo("AltFire")
	PISG A 3
    PISG A 0 A_AlertMonsters
    PISG A 0 A_FireBullets (2.0, 2.0, -1, Random(5, 10), "PlayerBulletPuff", FBF_NORANDOM|FBF_USEAMMO)
    PISG B 5 A_GunFlash
    PISG C 4
    PISG B 2 A_ReFire
    Goto Ready
  Flash:
    PISF A 5 Bright A_Light1
    Goto LightDone
  AltFire:
    TNT1 A 0 A_JumpIfInventory("PistolClip",12,2)
    TNT1 A 0 A_JumpIfInventory("Clip",1,2)
	TNT1 A 0
	Goto Ready
    PISG C 1 OffSet(0, 38)
	PISG C 1 OffSet(0, 44)
	PISG C 1 OffSet(0, 52)
	PISG C 1 OffSet(0, 60)
	PISG C 1 OffSet(0, 72)
	PISG C 10 A_OpenShotgun2
	PISG C 0 A_JumpIfInventory("Clip",1,"Reload")
	PISG C 10 A_LoadShotgun2
	PISG C 10 A_PlaySound ("weapons/sshotc", CHAN_WEAPON)
	PISG C 1 OffSet(0, 72)
    PISG C 1 OffSet(0, 60)
	PISG C 1 OffSet(0, 52)
	PISG C 1 OffSet(0, 44)
	PISG C 1 OffSet(0, 38)
	Goto Ready
  Reload:
	TNT1 A 0 A_TakeInventory("Clip",1)
	TNT1 A 0 A_GiveInventory("PistolClip",1)
	TNT1 A 0 A_JumpIfInventory("PistolClip",12,"Full")
	TNT1 A 0 A_JumpIfInventory("Clip",1,"Reload")
	Goto AltFire+10
  Full:
    TNT1 A 0
    Goto AltFire+10
  }
}

ACTOR PistolClip : Ammo
{
  Inventory.Amount 0
  Inventory.MaxAmount 12
  Ammo.BackpackAmount 0
  Ammo.BackpackMaxAmount 12
  Inventory.Icon "CLIPA0"
  +IGNORESKILL
}